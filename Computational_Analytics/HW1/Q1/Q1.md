# Clustering [25 points]
Given m data points $x^i$ , i = 1, . . . , m, K-means clustering algorithm groups them into k clusters by mini-
mizing the distortion function over {$r^{ij} , Î¼^j$}


$$
J = \sum_{i=1}^m \sum_{j=1}^k r^{ij} ||x^i - \mu^j ||^2
$$

where $r^{ij}$ = 1 if $x^i$ belongs to the j-th cluster and $r^{ij}$ = 0 otherwise.



## 1. 
### Prove that using the squared Euclidean distance $||x^i - \mu^j||^2$ as the dissimilarity function and minimizing the distortion function, we will have

$$
\mu^j = \frac{\sum_i r^{ij} x^i}{\sum_i r^{ij}}
$$


### **Answer**

with

$$
J = \sum_{i=1}^m \sum_{j=1}^k r^{ij} ||x^i - \mu^j ||^2 
$$ (1)

taking the derivative of (1) with respect to $\mu^j$

$$
\frac{\partial J}{\partial \mu^j} = 2 \sum_{i=1}^m \sum_{j=1}^k r^{ij} (x^i - \mu^j ) * -1 \\
= \sum_{i=1}^m \sum_{j=1}^k  (-2r^{ij}x^i + 2r^{ij}\mu^j )
$$ (2)

Setting (2) equal to 0 and solving for $\mu^j$ yields

$$
\sum_{i=1}^m \sum_{j=1}^k  (-2r^{ij}x^i + 2r^{ij}\mu^j ) = 0 \\
2r^{ij}\mu^j = 2r^{ij}x^i \\
\mu^j = \frac{\sum_i 2r^{ij}x^i}{\sum_i 2r^{ij}}
$$ (3)

reducing (3) yields

$$
\boxed{\mu^j = \frac{\sum_i r^{ij}x^i}{\sum_i r^{ij}}}
$$